<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora de Conversiones - Números Complejos Roberto Balmes Solís</title>

<style>
/* ==================== RESET ==================== */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

/* ==================== BODY ==================== */
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #e8edf3;
    padding: 25px;
}

/* ==================== CONTENEDOR ==================== */
.container {
    max-width: 850px;
    margin: auto;
    background: #ffffff;
    border-radius: 10px;
    padding: 35px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.15);
}

/* ==================== ENCABEZADOS ==================== */
h1 {
    text-align: center;
    margin-bottom: 25px;
    color: #1f2d3d;
    font-weight: 300;
}

h2 {
    color: #34495e;
    font-size: 20px;
    margin-bottom: 12px;
    font-weight: 500;
}

/* ==================== INSTRUCCIONES ==================== */
.instructions {
    background-color: #def7d6;
    padding: 15px;
    border-left: 5px solid #2ecc71;
    border-radius: 5px;
    margin-bottom: 25px;
}
.instructions ul {
    margin-left: 20px;
    margin-top: 10px;
}
.instructions li {
    margin-bottom: 5px;
}

/* ==================== FORM SECTIONS ==================== */
.form-section {
    margin-bottom: 30px;
    padding: 20px;
    background: #f7f9fc;
    border: 1px solid #d0d7e0;
    border-radius: 8px;
}

.input-group {
    display: flex;
    align-items: center;
    gap: 10px;
}

/* ==================== LABELS ==================== */
label {
    min-width: 20px;
    color: #34495e;
    font-weight: 500;
}

/* ==================== INPUTS ==================== */
input[type="text"] {
    width: 110px;
    padding: 8px;
    border-radius: 5px;
    border: 1px solid #cdd3dd;
    background: #fcfcfc;
    font-family: 'Courier New', monospace;
    text-align: center;
    font-size: 14px;
}

input[type="text"]:focus {
    border-color: #3498db;
    box-shadow: 0 0 3px rgba(52,152,219,0.5);
    outline: none;
}

input[readonly] {
    background: #ebebeb !important;
}

/* ==================== OPERADORES ==================== */
.operator {
    font-size: 16px;
    color: #555;
}

/* ==================== RESULTADOS ==================== */
.result {
    margin-top: 12px;
    padding: 15px;
    background: #f0f4f8;
    border-left: 5px solid #2980b9;
    font-family: 'Courier New', monospace;
    border-radius: 5px;
    font-size: 16px;
    color: #1c2833;
}

/* ==================== BOTÓN LIMPIAR ==================== */
.clear-btn {
    background-color: #e74c3c;
    color: white;
    padding: 12px 25px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    display: block;
    margin: 25px auto 0;
    font-size: 15px;
    font-weight: 600;
}
.clear-btn:hover {
    background-color: #c0392b;
    transform: translateY(-2px);
}
</style>
</head>

<body>

<div class="container">

<h1>Calculadora de Conversiones de Números Complejos</h1>

<div class="instructions">
<strong>Instrucciones:</strong>
<ul>
<li>Ingresa un número complejo en cualquier forma.</li>
<li>Las otras formas se calculan automáticamente.</li>
<li>Los ángulos pueden ser: pi, pi/2, pi/4, pi/6, 2*pi, etc.</li>
<li>Las raíces pueden ser: sqrt(2), sqrt(3), etc.</li>
<li>Los valores decimales también funcionan.</li>
</ul>
</div>

<!-- ==================== CARTESIANA ==================== -->
<div class="form-section">
<h2>Forma Cartesiana: a + bi</h2>

<div class="input-group">
<label>z =</label>
<input type="text" id="real" placeholder="a (ej: 2)">
<span class="operator">+</span>
<input type="text" id="imag" placeholder="b (ej: 3)">
<span class="operator">i</span>
</div>

<div class="result" id="cartesian-result">Ingresa valores arriba</div>
</div>

<!-- ==================== POLAR ==================== -->
<div class="form-section">
<h2>Forma Polar: r(cos θ + i sin θ)</h2>

<div class="input-group">
<label>z =</label>
<input type="text" id="modulus" placeholder="r">
<span class="operator">(cos</span>
<input type="text" id="angle" placeholder="θ">
<span class="operator">+ i sin</span>
<input type="text" id="angle2" readonly placeholder="θ">
<span class="operator">)</span>
</div>

<div class="result" id="polar-result">Ingresa valores arriba</div>
</div>

<!-- ==================== EXPONENCIAL ==================== -->
<div class="form-section">
<h2>Forma Exponencial: re^(iθ)</h2>

<div class="input-group">
<label>z =</label>
<input type="text" id="exp-modulus" placeholder="r">
<span class="operator">e^(i·</span>
<input type="text" id="exp-angle" placeholder="θ">
<span class="operator">)</span>
</div>

<div class="result" id="exponential-result">Ingresa valores arriba</div>
</div>

<button class="clear-btn" onclick="clearAll()">Limpiar Todo</button>

</div>

<script>
/* ==================== TODA TU LÓGICA JS (SIN CAMBIOS) ==================== */
/* → Copié exactamente lo que enviaste, solo corregí formato y espaciado */

let isUpdating = false;

function parseNumber(input) {
    if (!input && input !== 0) return 0;
    const inputStr = input.toString().trim();
    if (!inputStr) return 0;

    let expression = inputStr
        .replace(/sqrt\s*\(/gi, 'Math.sqrt(')
        .replace(/pi\b/gi, 'Math.PI');

    try {
        const result = Function('"use strict"; return (' + expression + ')')();
        if (isNaN(result) || !isFinite(result)) return 0;
        return result;
    } catch {
        return 0;
    }
}
function parseAngle(input) { return parseNumber(input); }

function angleToPI(angle) {
    if (Math.abs(angle) < 1e-8) return "0";
    const multiples = [
        { value: Math.PI, text: "pi" },
        { value: Math.PI/2, text: "pi/2" },
        { value: Math.PI/3, text: "pi/3" },
        { value: Math.PI/4, text: "pi/4" }
    ];
    for (let m of multiples) {
        if (Math.abs(angle - m.value) < 1e-8) return m.text;
    }
    return angle.toFixed(4);
}

function formatNumber(num) {
    if (Math.abs(num) < 1e-10) return "0";
    if (Math.abs(num - Math.round(num)) < 1e-8) return Math.round(num).toString();
    return num.toFixed(6);
}

function normalizeAngle(a) {
    while (a > Math.PI) a -= 2*Math.PI;
    while (a <= -Math.PI) a += 2*Math.PI;
    return a;
}

function updateFromCartesian() {
    if (isUpdating) return;
    isUpdating = true;

    const real = parseNumber(real.value);
    const imag = parseNumber(imag.value);

    const modulus = Math.sqrt(real*real + imag*imag);
    let angle = normalizeAngle(Math.atan2(imag, real));

    const aText = angleToPI(angle);

    modulusInput.value = formatNumber(modulus);
    angleInput.value = aText;
    angle2.value = aText;

    expMod.value = formatNumber(modulus);
    expAng.value = aText;

    updateResults(real, imag, modulus, angle);
    isUpdating = false;
}

function updateFromPolar() {
    if (isUpdating) return;
    isUpdating = true;

    const modulus = parseNumber(modulusInput.value);
    const angle = normalizeAngle(parseAngle(angleInput.value));
    angle2.value = angleToPI(angle);

    const realValue = modulus * Math.cos(angle);
    const imagValue = modulus * Math.sin(angle);

    real.value = formatNumber(realValue);
    imag.value = formatNumber(imagValue);

    expMod.value = formatNumber(modulus);
    expAng.value = angleToPI(angle);

    updateResults(realValue, imagValue, modulus, angle);
    isUpdating = false;
}

function updateFromExponential() {
    if (isUpdating) return;
    isUpdating = true;

    const modulus = parseNumber(expMod.value);
    const angle = normalizeAngle(parseAngle(expAng.value));

    const realValue = modulus * Math.cos(angle);
    const imagValue = modulus * Math.sin(angle);

    real.value = formatNumber(realValue);
    imag.value = formatNumber(imagValue);

    modulusInput.value = formatNumber(modulus);
    angleInput.value = angleToPI(angle);
    angle2.value = angleToPI(angle);

    updateResults(realValue, imagValue, modulus, angle);
    isUpdating = false;
}

function updateResults(real, imag, modulus, angle) {
    const angleText = angleToPI(angle);

    let c = "";
    if (real !== 0) c += formatNumber(real);
    if (imag > 0) c += (real ? " + " : "") + formatNumber(imag) + "i";
    if (imag < 0) c += (real ? " - " : "-") + formatNumber(-imag) + "i";
    if (!c) c = "0";
    cartesianResult.textContent = "z = " + c;

    polarResult.textContent = modulus === 0
        ? "z = 0"
        : `z = ${formatNumber(modulus)}(cos(${angleText}) + i sin(${angleText}))`;

    exponentialResult.textContent = modulus === 0
        ? "z = 0"
        : `z = ${formatNumber(modulus)} e^(i·${angleText})`;
}

function clearAll() {
    document.querySelectorAll("input").forEach(inp => inp.value = "");
    document.querySelectorAll(".result").forEach(r => r.textContent = "Ingresa valores arriba");
}

/* ==================== EVENTOS ==================== */
const real = document.getElementById("real");
const imag = document.getElementById("imag");
const modulusInput = document.getElementById("modulus");
const angleInput = document.getElementById("angle");
const angle2 = document.getElementById("angle2");
const expMod = document.getElementById("exp-modulus");
const expAng = document.getElementById("exp-angle");

const cartesianResult = document.getElementById("cartesian-result");
const polarResult = document.getElementById("polar-result");
const exponentialResult = document.getElementById("exponential-result");

real.addEventListener("input", updateFromCartesian);
imag.addEventListener("input", updateFromCartesian);
modulusInput.addEventListener("input", updateFromPolar);
angleInput.addEventListener("input", updateFromPolar);
expMod.addEventListener("input", updateFromExponential);
expAng.addEventListener("input", updateFromExponential);

</script>

</body>
</html>
